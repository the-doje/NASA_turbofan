# ğŸš€ í„°ë¹ˆ ì—”ì§„ RUL ì˜ˆì¸¡ í”„ë¡œì íŠ¸

## ğŸ“‹ í”„ë¡œì íŠ¸ ê°œìš”

í•­ê³µê¸° í„°ë¹ˆ ì—”ì§„ì˜ **ì”ì—¬ ìˆ˜ëª…(RUL, Remaining Useful Life)** ì„ ì˜ˆì¸¡í•˜ëŠ” ë¨¸ì‹ ëŸ¬ë‹ í”„ë¡œì íŠ¸ì…ë‹ˆë‹¤. NASAì˜ C-MAPSS ë°ì´í„°ì…‹ì„ ì‚¬ìš©í•˜ì—¬ ì˜ˆì§€ ì •ë¹„(Predictive Maintenance)ë¥¼ ìœ„í•œ ìµœì  ëª¨ë¸ê³¼ ì „ì²˜ë¦¬ ì „ëµì„ ì²´ê³„ì ìœ¼ë¡œ íƒìƒ‰

---

## ğŸ¯ í”„ë¡œì íŠ¸ ëª©í‘œ

1. **ë°ì´í„° ë³µì¡ë„ì— ë”°ë¥¸ ìµœì  ëª¨ë¸ ì„ íƒ**
2. **íš¨ê³¼ì ì¸ ì „ì²˜ë¦¬ ì „ëµ ë°œê²¬**
3. **ìµœì  ìŠ¤ì¼€ì¼ëŸ¬ ì„ íƒ**
4. **í•˜ì´í¼íŒŒë¼ë¯¸í„° ìµœì í™”ë¥¼ í†µí•œ ì„±ëŠ¥ ê·¹ëŒ€í™”**
5. **ì¼ë°˜í™” ê°€ëŠ¥í•œ ì‹¤í—˜ ë°©ë²•ë¡  í™•ë¦½**

---

## ğŸ“Š ë°ì´í„°ì…‹

### **C-MAPSS (Commercial Modular Aero-Propulsion System Simulation)**

| Dataset | ìš´ì˜ ì¡°ê±´ | ê³ ì¥ ëª¨ë“œ | í•™ìŠµ ì—”ì§„ | í…ŒìŠ¤íŠ¸ ì—”ì§„ | ë³µì¡ë„ |
|---------|----------|----------|-----------|-------------|--------|
| **FD001** | 1ê°œ | 1ê°œ | 100ëŒ€ | 100ëŒ€ | â­ ë‹¨ìˆœ |
| **FD004** | 6ê°œ | 2ê°œ | 249ëŒ€ | 248ëŒ€ | â­â­â­ ë³µì¡ |

**ì„¼ì„œ ë°ì´í„°:** 21ê°œ ì„¼ì„œ Ã— ì‹œê°„ ì‹œê³„ì—´ ë°ì´í„°

**ë°ì´í„° ë¶„í• :**
- Training Set: ëª¨ë¸ í•™ìŠµ (80%) + ê²€ì¦ (20%)
- Test Set: ìµœì¢… í‰ê°€ (1íšŒë§Œ ì‚¬ìš©)

---

## ğŸ”¬ ì‹¤í—˜ êµ¬ì¡°: 4-Branch ì ‘ê·¼ë²•

```
Branch 1: Model Selection (ëª¨ë¸ ì„ íƒ)
    â†“
Branch 2: Preprocessing (ì „ì²˜ë¦¬ ìµœì í™”)
    â†“
Branch 3: Scaler (ìŠ¤ì¼€ì¼ëŸ¬ ìµœì í™”)
    â†“
Branch 4: Hyperparameter Tuning (í•˜ì´í¼íŒŒë¼ë¯¸í„° íŠœë‹)
    â†“
[Branch 5: Ensemble] (ì˜ˆì •)
```

---

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
â”œâ”€â”€ branch1_FD001.ipynb          # Branch 1: FD001 ëª¨ë¸ ë¹„êµ
â”œâ”€â”€ branch1_FD004.ipynb          # Branch 1: FD004 ëª¨ë¸ ë¹„êµ
â”œâ”€â”€ branch2_FD001.ipynb          # Branch 2: FD001 ì „ì²˜ë¦¬ ì‹¤í—˜
â”œâ”€â”€ branch2_FD004.ipynb          # Branch 2: FD004 ì „ì²˜ë¦¬ ì‹¤í—˜
â”œâ”€â”€ branch3_FD001.ipynb          # Branch 3: FD001 ìŠ¤ì¼€ì¼ëŸ¬ ë¹„êµ
â”œâ”€â”€ branch3_FD004.ipynb          # Branch 3: FD004 ìŠ¤ì¼€ì¼ëŸ¬ ë¹„êµ
â”œâ”€â”€ branch4_FD001.ipynb          # Branch 4: FD001 í•˜ì´í¼íŒŒë¼ë¯¸í„° íŠœë‹
â”œâ”€â”€ branch4_FD004.ipynb          # Branch 4: FD004 í•˜ì´í¼íŒŒë¼ë¯¸í„° íŠœë‹
â””â”€â”€ README.md                    # í”„ë¡œì íŠ¸ ë¬¸ì„œ
```

---

## ğŸ”µ Branch 1: Model Selection

### **ëª©í‘œ**
> "ì–´ë–¤ ëª¨ë¸ì´ ì´ ë¬¸ì œì— ì í•©í•œê°€?"

### **ì‹¤í—˜ ëª¨ë¸**

#### **1-A: Tabular (í‘œ í˜•ì‹ ì²˜ë¦¬)**
- **XGBoost** (Gradient Boosting)
- **RandomForest** (Bagging)

#### **1-B: Fixed Window (ê³ ì • ìœˆë„ìš° ì‹œê³„ì—´)**
- **LSTM-30** (window_size=30)
- **LSTM-50** (window_size=50)

#### **1-C: Variable Window (ê°€ë³€ ìœˆë„ìš° ì‹œê³„ì—´)**
- **TCN** (Temporal Convolutional Network)

### **ì£¼ìš” ê²°ê³¼**

| Dataset | Best Model | Test RMSE | Test RÂ² | ì„ íƒ ì´ìœ  |
|---------|-----------|-----------|---------|----------|
| **FD001** | LSTM-50 | 37.23 | 0.49 | ì‹œê³„ì—´ íŒ¨í„´ ëª…í™•, ì¥ê¸° ì˜ì¡´ì„± í•™ìŠµ |
| **FD004** | XGBoost | 72.29 | 0.38 | ë³µì¡í•œ ë¹„ì„ í˜• ê´€ê³„, 6ê°€ì§€ ìš´ì˜ ì¡°ê±´ |

### **í•µì‹¬ ë°œê²¬ â­**

```
âœ… ë°ì´í„° ë³µì¡ë„ê°€ ëª¨ë¸ ì„ íƒì„ ê²°ì •

FD001 (ë‹¨ìˆœ) â†’ LSTM ìµœì 
  - 1ê°œ ìš´ì˜ ì¡°ê±´
  - ì‹œê³„ì—´ íŒ¨í„´ ëª…í™•
  - ìˆœí™˜ êµ¬ì¡°ê°€ ì¥ê¸° ì˜ì¡´ì„± í•™ìŠµ

FD004 (ë³µì¡) â†’ XGBoost ìµœì 
  - 6ê°€ì§€ ìš´ì˜ ì¡°ê±´
  - ë³µì¡í•œ ë¹„ì„ í˜• ìƒí˜¸ì‘ìš©
  - Tree êµ¬ì¡°ê°€ ì¡°ê±´ë³„ ë¶„ê¸° í•™ìŠµ

ğŸ’¡ ì¸ì‚¬ì´íŠ¸: 
"ë³µì¡ë„ ë‚®ì€ ì‹œê³„ì—´ â†’ LSTM"
"ë³µì¡ë„ ë†’ì€ ì‹œê³„ì—´ â†’ Tree ëª¨ë¸"
```

### **ë…¸íŠ¸ë¶ íŒŒì¼**
- `branch1_FD001.ipynb` - FD001 ëª¨ë¸ ë¹„êµ
- `branch1_FD004.ipynb` - FD004 ëª¨ë¸ ë¹„êµ

---

## ğŸ”µ Branch 2: Preprocessing

### **ëª©í‘œ**
> "ì–´ë–¤ ì „ì²˜ë¦¬ê°€ íš¨ê³¼ì ì¸ê°€?"

### **ì‚¬ì „ ë¶„ì„**

#### **1. Sensor Removal Analysis**
- ìƒê´€ê³„ìˆ˜ ë‚®ì€ ì„¼ì„œ: sensor_1, 5, 16, 18, 19
- ì´ìƒì¹˜ ë§ì€ ì„¼ì„œ: sensor_8, 14, 15, 18, 19
- **ì œê±° ëŒ€ìƒ:** 8ê°œ ì„¼ì„œ

#### **2. RUL Clipping Analysis**
- ì´ˆê¸° ì •ìƒ êµ¬ê°„ (RUL > 125): ë…¸ì´ì¦ˆ ë‹¤ìˆ˜, Target ë²”ìœ„ ê³¼ë„
- **ìµœì  ì„ê³„ê°’:** RUL â‰¤ 125

### **ì‹¤í—˜ ì¡°ê±´**

| Condition | ì„¤ëª… |
|-----------|------|
| **Baseline** | ì „ì²˜ë¦¬ ì—†ìŒ (ì›ë³¸ ë°ì´í„°) |
| **RUL clipping** | RUL â‰¤ 125ë¡œ ì œí•œ |
| **Sensor removal** | 8ê°œ ì„¼ì„œ ì œê±° |
| **Both** | RUL clipping + Sensor removal |

### **ì£¼ìš” ê²°ê³¼**

#### **FD001 (LSTM-50)**

| Condition | Train RMSE | Test RMSE | Test MAE | ê°œì„ ìœ¨ |
|-----------|------------|-----------|----------|--------|
| Baseline | 23.81 | 35.26 | 24.50 | - |
| **RUL clipping** | 8.81 | **15.45** | 12.26 | **56.19%** â­ |
| Sensor removal | 9.27 | 16.46 | 13.38 | 53.31% |
| Both | 7.87 | 16.19 | 12.64 | 54.08% |

#### **FD004 (XGBoost)**

| Condition | Train RMSE | Test RMSE | Test MAE | ê°œì„ ìœ¨ |
|-----------|------------|-----------|----------|--------|
| Baseline | 46.77 | 72.34 | 53.41 | - |
| **RUL clipping** | 14.45 | **16.24** | 10.41 | **77.54%** â­ |
| Sensor removal | 14.86 | 16.49 | 10.61 | 77.20% |
| Both | 14.86 | 16.49 | 10.61 | 77.20% |

### **í•µì‹¬ ë°œê²¬ â­**

```
âœ… RUL Clippingì´ í•µì‹¬!
  - FD001: 56% ê°œì„ 
  - FD004: 78% ê°œì„ 
  - Target ë²”ìœ„ ì¶•ì†Œ + ì´ˆê¸° ë…¸ì´ì¦ˆ ì œê±°

ğŸ’¡ ì¸ì‚¬ì´íŠ¸:
"ì˜¬ë°”ë¥¸ ì „ì²˜ë¦¬ í•˜ë‚˜ > ì—¬ëŸ¬ ë³µì¡í•œ ì „ì²˜ë¦¬"
"ì‚¬ì „ EDAë¥¼ í†µí•œ ë¬¸ì œ ì´í•´ê°€ í•µì‹¬"
```

### **ë…¸íŠ¸ë¶ íŒŒì¼**
- `branch2_FD001.ipynb` - FD001 ì „ì²˜ë¦¬ ì‹¤í—˜ (LSTM-50 ê¸°ë°˜)
- `branch2_FD004.ipynb` - FD004 ì „ì²˜ë¦¬ ì‹¤í—˜ (XGBoost ê¸°ë°˜)

---

## ğŸ”µ Branch 3: Scaler

### **ëª©í‘œ**
> "ì–´ë–¤ ìŠ¤ì¼€ì¼ëŸ¬ê°€ ì í•©í•œê°€?"

### **ì „ì œ ì¡°ê±´**
- **ì „ì²˜ë¦¬:** RUL Clippingë§Œ ì ìš©
- **ëª¨ë¸:** LSTM (window_size=50)
- **ì´ìœ :** Tree ëª¨ë¸ì€ ìŠ¤ì¼€ì¼ë§ ë¶ˆí•„ìš”

### **ì‹¤í—˜ ìŠ¤ì¼€ì¼ëŸ¬**

| Scaler | íŠ¹ì§• | ì´ìƒì¹˜ ëŒ€ì‘ |
|--------|------|------------|
| **StandardScaler** | í‰ê·  0, í‘œì¤€í¸ì°¨ 1 | ì•½í•¨ |
| **MinMaxScaler** | [0, 1] ë²”ìœ„ | ë§¤ìš° ì•½í•¨ |
| **RobustScaler** | ì¤‘ì•™ê°’, IQR ê¸°ë°˜ | ê°•í•¨|
| **MaxAbsScaler** | [-1, 1] ë²”ìœ„ | ì¤‘ê°„ |

### **ì£¼ìš” ê²°ê³¼**

#### **FD001**

| Scaler | Train RMSE | Test RMSE | Test MAE | Test RÂ² | ê°œì„ ìœ¨ |
|--------|------------|-----------|----------|---------|--------|
| **Standard** | 7.66 | **15.70** | 11.73 | 0.749 | **0.00%** â­ |
| MinMax | 41.43 | 41.06 | 37.38 | -0.716 | **-161.56%** âŒ |
| Robust | 7.80 | 16.23 | 12.34 | 0.732 | -3.38% |

#### **FD004**

| Scaler | Train RMSE | Test RMSE | Test MAE | Test RÂ² | ê°œì„ ìœ¨ |
|--------|------------|-----------|----------|---------|--------|
| Standard | 41.92 | 37.26 | 34.99 | -0.679 | 0.00% |
| MinMax | 41.92 | 37.19 | 34.92 | -0.673 | 0.19% |
| **Robust** | 15.45 | **19.48** | 15.80 | 0.541 | **47.70%** â­ |

### **í•µì‹¬ ë°œê²¬ â­**

```
âš ï¸ ë°ì´í„° íŠ¹ì„±ì— ë”°ë¼ ìµœì  ìŠ¤ì¼€ì¼ëŸ¬ê°€ ë‹¤ë¦„!

âœ… FD001 (ë‹¨ìˆœ) â†’ StandardScaler ìµœì 
  - ê· ì¼í•œ ì„¼ì„œ ë¶„í¬
  - ì •ê·œë¶„í¬ ê°€ì • ì í•©
  - ì´ìƒì¹˜ ì ìŒ

âœ… FD004 (ë³µì¡) â†’ RobustScaler ì••ë„ì 
  - 6ê°€ì§€ ìš´ì˜ ì¡°ê±´
  - ì´ìƒì¹˜ ë§ìŒ
  - 48% ì••ë„ì  ê°œì„ 

âŒ MinMaxScalerëŠ” LSTMì— ì¹˜ëª…ì 
  - FD001: -161% (ì™„ì „ ë¶•ê´´)
  - Gradient í•™ìŠµ ë°©í•´
  - [0,1] ë²”ìœ„ì™€ tanh ë¶ˆì¼ì¹˜

ğŸ’¡ ì¸ì‚¬ì´íŠ¸:
"ë³µì¡ë„ â†‘ â†’ ìŠ¤ì¼€ì¼ëŸ¬ ì˜í–¥ â†‘â†‘"
"RobustScaler â‰  ë§ŒëŠ¥ (ë°ì´í„°ë³„ í…ŒìŠ¤íŠ¸ í•„ìˆ˜)"
```

### **ë…¸íŠ¸ë¶ íŒŒì¼**
- `branch3_FD001.ipynb` - FD001 ìŠ¤ì¼€ì¼ëŸ¬ ë¹„êµ
- `branch3_FD004.ipynb` - FD004 ìŠ¤ì¼€ì¼ëŸ¬ ë¹„êµ

---

## ğŸ”µ Branch 4: Hyperparameter Tuning

### **ëª©í‘œ**
> "ìµœì ì˜ íŒŒë¼ë¯¸í„° ì¡°í•©ì€?"

### **ê³ ì • ì¡°ê±´**
- **ì „ì²˜ë¦¬:** RUL Clipping
- **ìŠ¤ì¼€ì¼ëŸ¬:** 
  - FD001: StandardScaler (Branch 3 ìµœì )
  - FD004: RobustScaler (Branch 3 ìµœì )
- **ëª¨ë¸:**
  - FD001: LSTM-50
  - FD004: XGBoost

### **íŠœë‹ ì „ëµ**

```
ğŸ” 2ë‹¨ê³„ ì ‘ê·¼ë²•:

1ë‹¨ê³„: Random Search (ë„“ì€ ë²”ìœ„ íƒìƒ‰)
  - FD001: 10íšŒ ì‹œë„
  - FD004: 15íšŒ ì‹œë„
  - ëª©ì : ìœ ë§ ì˜ì—­ ë°œê²¬

2ë‹¨ê³„: Manual Grid Search (ì§‘ì¤‘ íƒìƒ‰)
  - Best ì£¼ë³€ ì„¸ë°€ íƒìƒ‰
  - ëª©ì : ì •í™•í•œ ìµœì ê°’ ë°œê²¬

ğŸ’¡ ì™œ 2ë‹¨ê³„?
  - Randomë§Œ: ì •í™•ë„ â†“
  - Gridë§Œ: ê³„ì‚° ë¹„ìš© â†‘â†‘
  - 2ë‹¨ê³„: íš¨ìœ¨ + ì •í™• âœ…
```

### **ì£¼ìš” ê²°ê³¼**

#### **- FD001 (LSTM)**

**ìµœì  í•˜ì´í¼íŒŒë¼ë¯¸í„°:**
```python
Units: [150, 75, 35]
Dropout: 0.3
Learning Rate: 0.001
Batch Size: 128
Optimizer: Adam
```

| ì§€í‘œ | íŠœë‹ ì „ (Branch 3) | íŠœë‹ í›„ (Branch 4) | ê°œì„ ìœ¨ |
|------|-------------------|-------------------|--------|
| **Test RMSE** | 15.70 | **14.16** | **+1.13%** |
| **Test MAE** | 11.73 | **10.93** | **+14.41%** |

#### **- FD004 (XGBoost)**

**XGBoost ìµœì  íŒŒë¼ë¯¸í„°:**
```python
n_estimators: 500
max_depth: 6
learning_rate: 0.025
subsample: 0.7 
colsample_bytree: 0.7
min_child_weight: 1
gamma: 0.2
```

| ì§€í‘œ | íŠœë‹ ì „ (Branch 2) | íŠœë‹ í›„ (Branch 4) | ê°œì„ ìœ¨ |
|------|-------------------|-------------------|--------|
| **Test RMSE** | 16.24 | **16.09** | **+0.92%** |
| **Test MAE** | 10.41 | **10.50** | **-0.86%** |

ğŸ’¡ ì¸ì‚¬ì´íŠ¸:<br>
"ëª¨ë¸ ì„±ëŠ¥ ì˜í–¥ ìš”ì¸: ì „ì²˜ë¦¬ 50-77% > ìŠ¤ì¼€ì¼ëŸ¬ 10% > íŠœë‹ 1-3%"<br>
"ë³µì¡ë„ê°€ ë†’ì€ ë°ì´í„°ì˜ ê²½ìš° í•˜ì´í¼íŒŒë¼ë¯¸í„° íŠœë‹ ì–´ë ¤ì›€"<br>


### **ë…¸íŠ¸ë¶ íŒŒì¼**
- `branch4_FD001.ipynb` - FD001 í•˜ì´í¼íŒŒë¼ë¯¸í„° íŠœë‹
- `branch4_FD004.ipynb` - FD004 í•˜ì´í¼íŒŒë¼ë¯¸í„° íŠœë‹

---

## ğŸ“ˆ ìµœì¢… ì„±ëŠ¥ ìš”ì•½

### **FD001 (ë‹¨ìˆœí•œ ìš´ì˜ì¡°ê±´)**

| Stage | Model | Method | Test RMSE |
|-------|-------|--------|-----------|
| Branch 1 | LSTM-50 | Baseline | 37.23 |
| Branch 2 | LSTM-50 | + RUL Clipping | 15.44 |
| Branch 3 | LSTM-50 | + StandardScaler | 15.70 |
| **Branch 4** | **LSTM-50** | **+ HP Tuning (Adam)** | **14.16** |

### **FD004 (ë³µì¡í•œ ìš´ì˜ì¡°ê±´)**

| Stage | Model | Method | Test RMSE |
|-------|-------|--------|-----------|
| Branch 1 | XGBoost | Baseline | 72.29 |
| Branch 2 | XGBoost | + RUL Clipping | 16.24 |
| Branch 3 | LSTM-50 | + RobustScaler | 19.48 |
| **Branch 4** | **XGBoost** | **+ HP Tuning** | **16.09** |

---

## ğŸ“Œ ë‹¤ìŒ ë‹¨ê³„ (Next Steps)

### **Branch 5: Ensemble (ì˜ˆì •)**

```python
ê³„íš:
1. LSTM + XGBoost ì¡°í•©
2. Simple Averaging / Weighted Averaging
3. Stacking (ë©”íƒ€ ëª¨ë¸)

ê¸°ëŒ€ íš¨ê³¼:
- ì¶”ê°€ ì„±ëŠ¥ ê°œì„ 
- ëª¨ë¸ ê°„ ì˜¤ë¥˜ ìƒí˜¸ ë³´ì™„

```
